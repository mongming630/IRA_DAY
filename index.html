<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Happy Birthday My Bestie!</title>
<style>
  body {
    margin: 0;
    background: radial-gradient(circle at center, #d8b4fe 0%, #a855f7 40%, #7c3aed 80%);
    font-family: "Poppins", sans-serif;
    color: #fff;
    text-align: center;
    overflow-x: hidden;
    scroll-behavior: smooth;
    position: relative;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  }

  main {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    padding: 20px;
    box-sizing: border-box;
  }

  h1 {
    font-size: clamp(2rem, 5vw, 2.8rem);
    margin-bottom: 10px;
    text-shadow: 0 4px 12px rgba(0,0,0,0.2);
    opacity: 0;
    transform: translateY(20px);
    transition: all 1s ease;
  }

  p {
    font-size: clamp(1rem, 3vw, 1.1rem);
    margin-bottom: 10px;
    opacity: 0;
    transform: translateY(20px);
    transition: all 1s ease 0.3s;
  }

  footer {
    text-align: center;
    font-size: 0.9rem;
    color: rgba(255,255,255,0.9);
    opacity: 0.7;
    margin-top: 120px;
    margin-bottom: 30px;
    padding: 0 20px;
  }

  #tap {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(6px);
    background: rgba(168, 85, 247, 0.3);
    display: flex;
    justify-content: center;
    align-items: center;
    color: #fff;
    font-weight: 600;
    font-size: clamp(1.1rem, 4vw, 1.3rem);
    text-shadow: 0 2px 6px rgba(0,0,0,0.3);
    transition: opacity 1s ease;
    cursor: pointer;
    z-index: 10;
    padding: 20px;
    box-sizing: border-box;
    text-align: center;
    -webkit-tap-highlight-color: transparent;
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }

  .hidden {
    opacity: 0;
    pointer-events: none;
  }

  .show {
    opacity: 1 !important;
    transform: translateY(0) !important;
  }

  #message {
    margin-top: 60vh;
    font-size: 1.3rem;
    opacity: 0;
    transform: translateY(30px);
    transition: all 2s ease;
    padding: 30px;
    max-width: 600px;
    margin: 60vh auto 0 auto;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    line-height: 1.6;
    width: 90%;
    max-width: 600px;
    box-sizing: border-box;
    word-wrap: break-word;
    overflow-wrap: break-word;
    margin-left: max(20px, env(safe-area-inset-left));
    margin-right: max(20px, env(safe-area-inset-right));
}

#message h2 {
    font-size: clamp(1.5rem, 4vw, 1.8rem);
    margin-top: 0;
    margin-bottom: 20px;
    color: #fff;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

#message p {
    font-size: clamp(1rem, 3vw, 1.2rem);
    margin-bottom: 20px;
    color: rgba(255, 255, 255, 0.9);
    opacity: 1 !important;
    transform: none !important;
}

#message .highlight {
    font-weight: bold;
    color: #ffd166;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);
}

#message .signature {
    font-size: clamp(1.2rem, 3vw, 1.4rem);
    font-style: italic;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.3);
    color: #fff;
    font-weight: 600;
}

#message.show {
    opacity: 1;
    transform: translateY(0);
}
</style>
</head>
<body>
  <div id="tap">‚ú® Tap me bitch ‚ú®</div>

  <main>
    <h1>üéÇ Happy Birthday, BFF! üéâ</h1>
    <p>Wishing you love, joy, hope! üíï</p>
  </main>

  <div id="message">
    <h2>HAPPY BIRTHDAY BOIII !!!</h2>
    
    <p>congrats gurang ka na, pwede na magbuntis. late aq pero nawa'y na-enjoy mo ang imong bornday, wag ka magbabago boi stay kupal.</p>
    
    <p>di aq sanay maglong message e, <span class="highlight">lab kita boi wag ka muna mamamatay</span>. magpapayaman pa tayo.</p>
    
    <div class="signature">‚Äî Lovingly your BFF üíå</div>
  </div>

  <footer>Made with ‚ù§Ô∏è</footer>

<script>
let audioContext = null;
let isPlaying = false;
let audioUnlocked = false;

function unlockAudioIOS() {
  if (audioUnlocked) return;
  
  audioContext = new (window.AudioContext || window.webkitAudioContext)();
  
  const buffer = audioContext.createBuffer(1, 1, 22050);
  const source = audioContext.createBufferSource();
  source.buffer = buffer;
  source.connect(audioContext.destination);
  
  if (source.start) {
    source.start(0);
  } else if (source.noteOn) {
    source.noteOn(0);
  }

  if (audioContext.state === 'suspended') {
    audioContext.resume();
  }
  
  audioUnlocked = true;
  console.log("Audio unlocked for Safari/iOS");
}

function playNote(freq, duration) {
  if (!audioContext || !audioUnlocked) return;
  
  try {
    if (audioContext.state === 'suspended') {
      audioContext.resume();
    }
    
    const now = audioContext.currentTime;
    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();
    
    oscillator.connect(gainNode);
    gainNode.connect(audioContext.destination);
    
    oscillator.frequency.value = freq;
    oscillator.type = 'triangle';
    
    gainNode.gain.setValueAtTime(0, now);
    gainNode.gain.linearRampToValueAtTime(0.1, now + 0.01);
    gainNode.gain.exponentialRampToValueAtTime(0.001, now + duration / 1000);
    
    oscillator.start(now);
    oscillator.stop(now + duration / 1000);
    
  } catch (error) {
    console.error("Error playing note:", error);
  }
}

function playBirthdaySongLoop() {
  if (!audioContext || !audioUnlocked || !isPlaying) return;
  
  const notes = [
    [264, 250], [264, 250], [297, 500], [264, 500], [352, 500], [330, 1000],
    [264, 250], [264, 250], [297, 500], [264, 500], [396, 500], [352, 1000],
    [264, 250], [264, 250], [528, 500], [440, 500], [352, 500], [330, 500], [297, 1000],
    [466, 250], [466, 250], [440, 500], [352, 500], [396, 500], [352, 1500]
  ];

  let delay = 0;
  for (const [freq, duration] of notes) {
    setTimeout(() => {
      if (isPlaying) {
        playNote(freq, duration);
      }
    }, delay);
    delay += duration * 1.15;
  }

  setTimeout(() => {
    if (isPlaying) {
      playBirthdaySongLoop();
    }
  }, delay);
}

function smoothScrollTo(targetY, duration = 4000) {
  const startY = window.scrollY;
  const diff = targetY - startY;
  const startTime = performance.now();

  function animate(time) {
    const elapsed = time - startTime;
    const progress = Math.min(elapsed / duration, 1);
    const ease = 1 - Math.pow(1 - progress, 3);
    window.scrollTo(0, startY + diff * ease);
    if (progress < 1) requestAnimationFrame(animate);
  }
  requestAnimationFrame(animate);
}

function startSurprise() {
  const tap = document.getElementById("tap");
  const h1 = document.querySelector("h1");
  const p = document.querySelector("p");
  const message = document.getElementById("message");

  if (!audioUnlocked) {
    unlockAudioIOS();
  }

  tap.classList.add("hidden");
  h1.classList.add("show");
  p.classList.add("show");

  setTimeout(() => {
    isPlaying = true;
    
    if (audioContext && audioContext.state === 'suspended') {
      audioContext.resume().then(() => {
        console.log("Audio context resumed, playing music");
        playBirthdaySongLoop();
      }).catch(err => {
        console.log("Could not resume audio:", err);
      });
    } else {
      playBirthdaySongLoop();
    }

    setTimeout(() => {
      message.classList.add("show");
      const y = message.getBoundingClientRect().top + window.scrollY - 100;
      smoothScrollTo(y, 4000);
    }, 5000);
  }, 300);
}

function handleFirstTouch() {
  unlockAudioIOS();
  document.removeEventListener('touchstart', handleFirstTouch);
  document.removeEventListener('click', handleFirstTouch);
}

document.addEventListener('touchstart', handleFirstTouch, { passive: true });
document.addEventListener('click', handleFirstTouch);

const tapElement = document.getElementById("tap");
tapElement.addEventListener("click", function(e) {
  e.preventDefault();
  e.stopPropagation();
  startSurprise();
});

tapElement.addEventListener("touchstart", function(e) {
  e.preventDefault();
  e.stopPropagation();
  startSurprise();
}, { passive: false });

document.body.addEventListener('click', function(e) {
  if (!audioUnlocked && e.target === document.body) {
    unlockAudioIOS();
  }
});

window.addEventListener('load', function() {
  if (!/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
    unlockAudioIOS();
  }
});
</script>
</body>
</html>
